"use client";

import { useEffect, useState } from "react";
import { Minus, Copy, X, Square } from "lucide-react";
import './toolbar.css';

interface WindowState {
    isMaximized: boolean;
}

export function Toolbar() {
    const [isMaximized, setIsMaximized] = useState(false);

    const handleMinimize = () => {
        window.api.send('minimizeApp');
    };

    const handleMaximize = () => {
        window.api.send('maximizeApp');
    };

    const handleClose = () => {
        window.api.send('closeApp');
    };

    useEffect(() => {
        window.api.receive('windowStateChange', (state: WindowState) => {
            setIsMaximized(state.isMaximized);
        });
    }, []);

    return (
        <div className="w-full">
            <nav className="flex items-center flex-row relative toolbar">
                <div className="title-wrapper flex flex-row justify-center shrink-0 items-center">
                    <a className="pr-4 pl-4 hover:scale-110 transition-all cursor-pointer" href="https://logie.lol" target="_blank">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12.222 4.95433C10.3429 5.14709 8.92691 5.86613 7.76694 7.21326C7.41962 7.61609 7.22592 7.91497 6.88082 8.56688C6.64482 9.0152 6.61142 9.19496 6.71161 9.48951C6.92757 10.1198 7.56433 10.7435 8.77106 11.5059C8.94472 11.6163 9.08722 11.703 9.13842 11.7311C9.16291 11.7441 9.28314 11.8112 9.4056 11.8784C9.66386 12.0257 10.4609 12.4068 10.9418 12.6169C11.1266 12.6971 11.3159 12.7794 11.3649 12.801C12.0773 13.115 13.6291 13.6045 14.6266 13.8276C15.3947 13.9987 15.7064 14.0442 16.41 14.081C17.5766 14.146 18.1666 13.9619 18.485 13.4356C18.6498 13.1627 18.8056 12.6559 18.9147 12.043C18.9949 11.5947 19.0127 10.9276 18.957 10.5378C18.8679 9.90534 18.701 9.2686 18.4961 8.77479C18.436 8.62536 18.3848 8.48891 18.3826 8.47375C18.3826 8.46075 18.3737 8.44776 18.367 8.44776C18.3492 8.44776 18.2935 8.32864 18.3002 8.30482C18.3024 8.29615 18.2935 8.28316 18.2824 8.27666C18.2713 8.27016 18.2223 8.20086 18.1778 8.12289C18.0664 7.93663 17.8304 7.57711 17.7948 7.54246C17.7792 7.52513 17.7191 7.44716 17.6612 7.36919C17.6033 7.28906 17.5076 7.16994 17.4497 7.10713C17.3918 7.04216 17.3428 6.97502 17.3428 6.95986C17.3428 6.9447 17.3362 6.93387 17.3273 6.93603C17.3161 6.9382 17.2337 6.8624 17.1425 6.76927C17.0512 6.67397 16.9688 6.59384 16.9577 6.58951C16.9287 6.57651 16.597 6.30146 16.5703 6.26464C16.5547 6.24515 16.5413 6.23648 16.5413 6.24731C16.5413 6.25598 16.4589 6.19966 16.3588 6.12386C16.1851 5.99608 16.1183 5.95276 15.8556 5.79899C15.722 5.72319 15.2366 5.48062 15.1498 5.44597C14.4774 5.18824 13.7984 5.02797 13.1148 4.96083C12.8989 4.94134 12.3935 4.93701 12.222 4.95433Z" fill="white"/>
                            <path d="M4.89482 6.4206C4.89037 6.42493 4.77014 6.44009 4.62987 6.45525C3.62575 6.55487 2.45019 6.88191 1.94479 7.20245C1.406 7.54464 1.02082 7.95181 0.787047 8.42612C0.718027 8.56257 0.644555 8.71417 0.620064 8.76182C0.591983 8.81967 0.53948 8.86751 0.514251 9.06172C0.491721 9.23515 0.514449 9.41078 0.543201 9.58329V9.58329V9.58329C0.566198 9.72554 0.601503 9.86553 0.648718 10.0017L0.702442 10.1566C0.840481 10.5616 1.09652 11.0836 1.32807 11.4431C2.04276 12.5433 3.24948 13.6847 4.84139 14.7654C5.48928 15.2051 5.77649 15.3762 6.87857 15.9847C7.34612 16.2425 8.09421 16.615 8.48161 16.7818C8.64636 16.8532 8.92244 16.9723 9.09388 17.046C10.0512 17.4597 10.285 17.5485 11.3871 17.908C12.2554 18.1917 12.625 18.2956 13.4488 18.4841C14.4329 18.7093 15.0496 18.8219 15.9624 18.9389C16.7907 19.0472 17.1625 19.0645 18.4338 19.0537C19.4958 19.0472 19.6271 19.0407 19.8832 18.9995C20.7292 18.8609 21.3883 18.6443 22.005 18.3043C22.3968 18.0877 22.8043 17.7022 23.0536 17.3167C23.1071 17.2322 23.2028 17.0417 23.2651 16.89L23.3787 16.615L23.434 16.4566C23.455 16.3963 23.4701 16.3339 23.4788 16.2706V16.2706C23.493 16.1677 23.4905 16.0632 23.4713 15.9612L23.4484 15.8388L23.3631 15.5841L23.2585 15.3133C23.0803 14.8499 22.6729 14.1027 22.408 13.7475C22.1519 13.4053 22.1029 13.3425 21.9849 13.219C21.9248 13.1562 21.8603 13.0804 21.8402 13.0501C21.8024 12.9959 21.789 12.9808 21.2836 12.4827C21.1217 12.3232 20.9802 12.1871 20.9417 12.1544C20.9354 12.149 20.9267 12.1456 20.923 12.1382V12.1382C20.9184 12.1288 20.9261 12.1104 20.9161 12.1136C20.9143 12.1141 20.9121 12.1152 20.9096 12.1166C20.8984 12.1231 20.8539 12.0928 20.8116 12.0473C20.727 11.9607 20.6446 11.8914 20.3485 11.6618C20.1058 11.4734 20.0145 11.3889 20.0145 11.3521V11.3521C20.0145 11.3319 19.9904 11.338 19.9734 11.327C19.9648 11.3215 19.9552 11.3138 19.9455 11.3045C19.8587 11.22 19.8431 11.2482 19.8297 11.5059C19.7919 12.1578 19.527 13.3078 19.3021 13.7886C19.1351 14.1482 18.8501 14.4254 18.4672 14.5986C18.0798 14.7741 17.8705 14.8325 17.3784 14.904C16.6972 15.0036 15.6084 14.9105 14.493 14.6614C13.4844 14.4362 12.6695 14.1893 11.543 13.7691C11.1578 13.624 10.9418 13.5331 10.4075 13.2905C10.2739 13.2277 10.1069 13.1541 10.0401 13.1259C9.91098 13.0696 9.34769 12.7945 9.21633 12.7209C9.17403 12.6971 9.05825 12.6364 8.96029 12.5844C8.89396 12.5493 8.83375 12.5141 8.80109 12.4923C8.78282 12.4801 8.77073 12.4545 8.74878 12.4545V12.4545C8.72206 12.4545 8.14987 12.1188 7.93168 11.9759C7.51311 11.7008 7.00103 11.3023 7.02997 11.2741C7.03888 11.2655 7.03665 11.2633 7.02329 11.2676C6.99435 11.2763 6.63589 10.9254 6.47559 10.7327C6.22845 10.4338 6.00136 10.0548 5.90339 9.77974C5.78762 9.45054 5.78094 8.96324 5.88558 8.64487C5.95015 8.45428 6.27076 7.8262 6.46223 7.51649C6.58914 7.31074 6.84963 6.94472 7.05446 6.68266C7.13016 6.58736 7.18582 6.49856 7.18359 6.48773C7.17914 6.47474 7.09676 6.45958 6.9988 6.45092C6.8051 6.43142 4.91263 6.40543 4.89482 6.4206ZM2.81088 8.74016C2.98454 8.82463 3.10477 8.95458 3.14929 9.10618C3.18269 9.2188 3.18269 9.23613 3.14929 9.35092C3.09586 9.52851 2.89993 9.7126 2.67061 9.8014C2.52589 9.85771 2.47691 9.86638 2.29212 9.86638C2.09842 9.86638 2.06725 9.85988 1.93143 9.7949C1.38818 9.53934 1.49728 8.91992 2.12291 8.70334C2.20974 8.67302 2.28766 8.66436 2.4591 8.66869C2.65503 8.67519 2.69955 8.68385 2.81088 8.74016ZM10.8171 15.3242C10.9975 15.3697 11.1511 15.4498 11.2914 15.5732C11.5274 15.7768 11.6142 16.0757 11.5073 16.2988C11.4339 16.4504 11.3003 16.5717 11.1422 16.6323C10.9418 16.7081 10.7882 16.7146 10.5945 16.6561C10.1114 16.5154 9.84196 16.249 9.82192 15.8981C9.81524 15.7768 9.82192 15.7422 9.87758 15.6404C9.95328 15.5018 10.0535 15.4173 10.2316 15.3458C10.3874 15.283 10.6279 15.2744 10.8171 15.3242ZM21.4595 15.831C21.7311 15.9133 21.9137 16.0692 22.0495 16.3356C22.1541 16.5349 22.1653 16.6518 22.1052 16.8402C21.9894 17.2084 21.6532 17.334 21.268 17.1521C21.1411 17.0915 20.9697 16.9399 20.8829 16.8077C20.796 16.6778 20.727 16.4699 20.727 16.3443C20.727 16.132 20.8561 15.9284 21.0476 15.8418C21.1856 15.779 21.2814 15.7768 21.4595 15.831Z" fill="white"/>
                        </svg>
                    </a>
                    <span className="opacity-50 text-[11px] select-none">beta</span>
                </div>
                <div style={{ WebkitAppRegion: 'drag' } as React.CSSProperties} className="w-full h-[32px]"></div>
                <div className="flex flex-row">
                    <button className="toolbar-button" id="minimizeButton" onClick={handleMinimize}>
                        <Minus size={16} />
                    </button>
                    <button className="toolbar-button" id="maximizeButton" onClick={handleMaximize}>
                        {isMaximized ? <Copy size={13} style={{ transform: "scaleX(-100%)" }} /> : <Square size={13} />}
                    </button>
                    <button className="toolbar-button" id="closeButton" onClick={handleClose}>
                        <X size={16} />
                    </button>
                </div>
            </nav>
        </div>
    );
}